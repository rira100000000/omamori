# frozen_string_literal: true

require 'sinatra'

# XSS (Cross-Site Scripting) の脆弱性を含むデモコード
# ユーザーからの入力を適切にエスケープせずにHTMLに出力している例

get '/greet' do
  # ユーザーからの入力 (name) を取得
  name = params['name']

  # 取得した入力をそのままHTMLに埋め込んで出力
  # ここにXSSの脆弱性がある
  "<h1>Hello, #{name}!</h1>"
end

# 実行方法:
# 1. このファイルを保存
# 2. ターミナルで `ruby demo/xss_vulnerability.rb` を実行
# 3. ブラウザで `http://localhost:4567/greet?name=<script>alert('XSS')</script>` にアクセス
#    アラートが表示されれば脆弱性がある